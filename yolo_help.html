<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>YOLO Main Functions: &#8212; yolo_model  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=279e0f84" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="YOLO Post-processing Functions:" href="yolo_post_help.html" />
    <link rel="prev" title="Welcome to the YOLO model documentation!" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="yolo_post_help.html" title="YOLO Post-processing Functions:"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to the YOLO model documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">yolo_model  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">YOLO Main Functions:</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-yolo_help">
<span id="yolo-main-functions"></span><h1>YOLO Main Functions:<a class="headerlink" href="#module-yolo_help" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="yolo_help.GroundTruthDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">GroundTruthDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nclasses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reproducible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.GroundTruthDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>This dataset will generate a set of random images of size N x N. And they will contain poisson distributed cells with mean M.</p>
<section id="parameters-for-initialization">
<h2>Parameters for Initialization:<a class="headerlink" href="#parameters-for-initialization" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>N<span class="classifier">int</span></dt><dd><p>The number of images to generate for this simulated dataset; Default - 256</p>
</dd>
<dt>M<span class="classifier">int</span></dt><dd><p>The mean number of cells appended to each image, sampled from a Poisson distribution; Default - 350</p>
</dd>
<dt>nclasses<span class="classifier">int</span></dt><dd><p>The number of classes to categorize this collection of simulated cells; Default = 3</p>
</dd>
<dt>reproducible<span class="classifier">bool</span></dt><dd><p>If True, set np.random.seed() to the integer index supplied</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>out_arr<span class="classifier">3 x N array</span></dt><dd><ul class="simple">
<li><p>out_arr[0] is a 1 x N x N array defining the base image</p></li>
<li><p>out_arr[1] is a X x 4 array containing the bbox info for X cells</p></li>
<li><p>out_arr[2] is a X x 1 array containing the categorical label for the cell within the corresponding bbox; 0 - smooth boundary, 1 - sharp boudnary; 2 - bumpy boundary</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="yolo_help.Net">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">Net</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nclasses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.Net" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A neural network using the YOLO framework, with a batch size of 1 and an input layer capable of accepting inputs of variable shape.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>nclasses<span class="classifier">int</span></dt><dd><p>Default - 3; The number of distinct classes in the dataset</p>
</dd>
</dl>
</section>
<section id="id1">
<h2>Returns:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>Net<span class="classifier">torch.nn.Module</span></dt><dd><p>A neural network which can take input images with any number of channels</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="yolo_help.Net.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.Net.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward method for the yolo network.</p>
<section id="inputs">
<h3>Inputs<a class="headerlink" href="#inputs" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>x<span class="classifier">torch.Tensor</span></dt><dd><p>Object is of size 1 x CH x ROW x COL. # of channels, rows, and columns are arbitrary. This differs from the original yolo paper, which requires a fixed number of channels, rows, and columns.</p>
</dd>
</dl>
</section>
<section id="outputs">
<h3>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>x<span class="classifier">torch.Tensor</span></dt><dd><p>Object is of size 5 * bbox_per_cell (2) + num_classes (3) x ROW x COL, where ROW and COL are equal to the input image size divided by the network’s stride (8). The five numbers per cell are [cx, cy, scalex, scaley, confidence].</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="yolo_help.VariableInputConv2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">VariableInputConv2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.VariableInputConv2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Note the assumption here is that we have batch size one, so I can work with the batch dimension.
This version adds a few extra convolutions.</p>
<p>We only process 1 image at a time, so we can use the batch dimension.</p>
<p>Step 1: move channel dimension to batch dimension.  Now we have N samples, with one channel each.</p>
<dl class="simple">
<dt>Step 2: apply some convolutions and relus, to end up with an N x M array of images. Where M is fixed,</dt><dd><p>and N is variable.</p>
</dd>
<dt>Step 3: Take a softmax of the result over the N channels.  Now matrix multiply, and N x M array, with a N x 1 array,</dt><dd><p>to get an M x 1 array (where M is fixed).</p>
</dd>
</dl>
<p>Step 4: Return the result which is a fixed number of channels.</p>
<p>What’s nice is it is permutation invariant.  So if we input an RGB image, or a BGR image, the result would be exactly the same.
We don’t need to have the channels in any specific order.</p>
<p>WORKING TODO
Change so it supports a batch dimension
This requires every image in a batch to have the same number of channels, but I think its okay</p>
<dl class="py method">
<dt class="sig sig-object py" id="yolo_help.VariableInputConv2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.VariableInputConv2d.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.bbox_to_rectangles">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">bbox_to_rectangles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.bbox_to_rectangles" title="Link to this definition">¶</a></dt>
<dd><p>This function converts a set of bounding boxes of the form [cx,cy,w,h] to a set of rectangular objects for visualization purposes</p>
<section id="id2">
<h2>Parameters:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>bbox<span class="classifier">A N x 4 array[numpy.float64]</span></dt><dd><p>Contains the bbox info N bboxes of the form [xc,cy,w,h]</p>
</dd>
</dl>
</section>
<section id="id3">
<h2>Returns:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>out<span class="classifier">matplotlib.collections.PolyCollection</span></dt><dd><p>Contains N rectangles to be plotted later</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.convert_data">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">convert_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.convert_data" title="Link to this definition">¶</a></dt>
<dd><p>Convert the outputs from the YOLO neural network into bounding boxes for performance quantification. Note that this operation is not differentiable. It also outputs the raw data, reformmated into a list intsead of an image of grid cells. These outputs are differentiable. The last one of these outputs is the score (data[…,-1]). Note that class probabilities are NOT output by this function.</p>
<section id="id4">
<h2>Parameters:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>out<span class="classifier">torch.Tensor</span></dt><dd><p>The output object from the primary YOLO neural network</p>
</dd>
<dt>B<span class="classifier">int</span></dt><dd><p>The number of bounding boxes per block that the model will output.  (Automatically defined when initializing the network)</p>
</dd>
<dt>stride<span class="classifier">int</span></dt><dd><p>The number of pixels to pass over when convolving the input image in each layer (Automatically defined when initializing the network)</p>
</dd>
</dl>
</section>
<section id="id5">
<h2>Returns:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>bboxes<span class="classifier">torch.Tensor of size N x 4</span></dt><dd><p>N is the number of bounding boxes output from the network; Bounding boxes are of the form [cx,cy,scalex,scaley]. There are no gradient computations done here. These bounding boxes are for visualization or downstream analysis.</p>
</dd>
<dt>data<span class="classifier">torch.Tensor of size N x 5</span></dt><dd><p>N is the number of bounding boxes output from the network; Bounding boxes are of the form [cx,cy,w,h,conf]. There are gradient computations done here. These are for our loss function and, potentially, other downstream analysis.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.get_assignment_inds">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">get_assignment_inds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.get_assignment_inds" title="Link to this definition">¶</a></dt>
<dd><p>Assigns each training bounding box to a specific cell, and picks the bounding box from that cell with the best iou.</p>
<section id="id6">
<h2>Parameters:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>bboxes<span class="classifier">torch.Tensor of size [N, 4]</span></dt><dd><p>N is the number of bounding boxes computed for a single image and is equal to (np.shape(I)[0] / stride) * (np.shape(I)[0] / stride) * net.B</p>
</dd>
<dt>bbox<span class="classifier">torch.Tensor of size [X, 4]</span></dt><dd><p>X is the true number of bboxes associated with image I</p>
</dd>
<dt>shape<span class="classifier">4-dimensional torch.Tensor</span></dt><dd><p>The shape of the data directly output from the YOLO neural network</p>
</dd>
<dt>stride<span class="classifier">int</span></dt><dd><p>The number of pixels to pass over when convolving the input image in each layer (Automatically defined when initializing the network)</p>
</dd>
<dt>B<span class="classifier">int</span></dt><dd><p>The number of bboxes generated by the YOLO neural network at each block</p>
</dd>
</dl>
</section>
<section id="id7">
<h2>Returns:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>assignment_inds<span class="classifier">numpy array of size X</span></dt><dd><p>The index of the bounding box from the ‘bboxes’ parameter cooresponding to the ith bounding box from the ‘bbox’ parameter</p>
</dd>
<dt>ious<span class="classifier">numpy array of size X</span></dt><dd><p>The iou between the ith bounding box from the ‘bbox’ parameter, and the corresponding bbox from the ‘bboxes’ parameter</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.get_best_bounding_box_per_cell">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">get_best_bounding_box_per_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.get_best_bounding_box_per_cell" title="Link to this definition">¶</a></dt>
<dd><p>Get the best bounding box for each cell output from the YOLO neural network.</p>
<section id="id8">
<h2>Parameters:<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>bboxes<span class="classifier">torch.Tensor of size [N, 4]</span></dt><dd><p>N is the number of bounding boxes computed for a single image and is equal to (np.shape(I)[0] / stride) * (np.shape(I)[0] / stride) * net.B</p>
</dd>
<dt>scores<span class="classifier">torch.Tensor of size [N,1]</span></dt><dd><p>The confidence for each corresponding box in the ‘bboxes’ parameter</p>
</dd>
<dt>B<span class="classifier">int</span></dt><dd><p>Default - 2; The number of bboxes generated by the YOLO neural network at each cell</p>
</dd>
</dl>
</section>
<section id="id9">
<h2>Returns:<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>bboxes_out<span class="classifier">torch.Tensor of size [N/B, 4]</span></dt><dd><p>A list of the best bounding boxes for each cell</p>
</dd>
<dt>scores_out<span class="classifier">torch.Tensor of size [N/B, 1]</span></dt><dd><p>A list of the confidence for the corresponding bounding boxes in ‘bboxes_out’</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.get_reg_targets">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">get_reg_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">assignment_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.get_reg_targets" title="Link to this definition">¶</a></dt>
<dd><p>What are the true bounding box parameters we want to predict.</p>
<section id="id10">
<h2>Parameters:<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>assignment_inds<span class="classifier">numpy array of size X</span></dt><dd><p>The idx at position i corresponds to the bounding box output from the YOLO framework which most accurately encompasses bounding box ‘i’ in the ‘bbox’ (ground truth labels) parameter</p>
</dd>
<dt>bbox<span class="classifier">torch.Tensor of size [X, 4]</span></dt><dd><p>X is the true number of bboxes associated with image I</p>
</dd>
<dt>B<span class="classifier">int</span></dt><dd><p>The number of bboxes generated by the YOLO neural network at each block</p>
</dd>
<dt>shape<span class="classifier">4-dimensional torch.Tensor</span></dt><dd><p>The shape of the data directly output from the YOLO neural network</p>
</dd>
<dt>stride<span class="classifier">int</span></dt><dd><p>The number of pixels to pass over when convolving the input image in each layer (Automatically defined when initializing the network)</p>
</dd>
</dl>
</section>
<section id="id11">
<h2>Returns:<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>shiftx<span class="classifier">numpy array of shape [X,]</span></dt><dd><p>Defines the shift in x needed to align bbox[i] with the corresponding best estimated bounding box</p>
</dd>
<dt>shifty<span class="classifier">numpy array of shape [X,]</span></dt><dd><p>Defines the shift in y needed to align bbox[i] with the corresponding best estimated bounding box</p>
</dd>
<dt>scalex<span class="classifier">numpy array of shape [X,]</span></dt><dd><p>Defines the scale in x needed to align bbox[i] with the corresponding best estimated bounding box</p>
</dd>
<dt>scaley<span class="classifier">numpy array of shape [X,]</span></dt><dd><p>Defines the scale in y needed to align bbox[i] with the corresponding best estimated bounding box</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.imshow">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">imshow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.imshow" title="Link to this definition">¶</a></dt>
<dd><p>This function will normalize the image I and plot it on the axes object ax</p>
<section id="id12">
<h2>Parameters:<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>I<span class="classifier">1 x N x N array[numpy.float64]</span></dt><dd><p>An image</p>
</dd>
<dt>ax<span class="classifier">matplotlib.axes._axes.Axe object</span></dt><dd><p>An empty axis onto which I will be plotted</p>
</dd>
</dl>
</section>
<section id="id13">
<h2>Returns:<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h2>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.iou">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nopairwise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.iou" title="Link to this definition">¶</a></dt>
<dd><p>Calculate pairwise iou between a set of estimated bounding boxes (bbox0) and the set of ground truth bounding boxes (bbox1).</p>
<section id="id14">
<h2>Parameters:<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>bbox0<span class="classifier">torch.Tensor of size [N, 4]</span></dt><dd><p>N is the number of bounding boxes</p>
</dd>
<dt>bbox1<span class="classifier">torch.Tensor of size [N, 4]</span></dt><dd><p>N is the number of bounding boxes</p>
</dd>
<dt>nopairwise<span class="classifier">bool</span></dt><dd><p>If True, compute pointwise, not pairwise IOU</p>
</dd>
</dl>
</section>
<section id="id15">
<h2>Returns:<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>out<span class="classifier">Array of length N</span></dt><dd><p>An array containing the pairwise (or pointwise) IOU values between the elements bbox0 and bbox 1</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yolo_help.train_yolo_model">
<span class="sig-prename descclassname"><span class="pre">yolo_help.</span></span><span class="sig-name descname"><span class="pre">train_yolo_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nepochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizername</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lossname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#yolo_help.train_yolo_model" title="Link to this definition">¶</a></dt>
<dd><p>Train a neural network defined by the YOLO framework and other provided hyperparameters using the simulated dataset ‘groundtruth’.</p>
<section id="id16">
<h2>Parameters:<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>nepochs<span class="classifier">int</span></dt><dd><p>The number of epochs used to train the model</p>
</dd>
<dt>lr<span class="classifier">float</span></dt><dd><p>The learning rate used to train the model</p>
</dd>
<dt>outdir<span class="classifier">str</span></dt><dd><p>The output directory where all files will be saved during training, or where all files were saved if the model has already been trained.</p>
</dd>
<dt>modelname<span class="classifier">str</span></dt><dd><p>The file name of the model used during training</p>
</dd>
<dt>optimizername<span class="classifier">str</span></dt><dd><p>The file name of the optimizer used during training</p>
</dd>
<dt>lossname<span class="classifier">str</span></dt><dd><p>The file name of the losses computed during training</p>
</dd>
<dt>resume<span class="classifier">bool</span></dt><dd><p>Default - False; If True, resume the training of model ‘outdir/modelname’ or load the pretrained model saved at ‘outdir/modelname’</p>
</dd>
<dt>J_path<span class="classifier">str</span></dt><dd><p>Default - None; The file path to the image to be used during the validation portion of training</p>
</dd>
</dl>
</section>
<section id="id17">
<h2>Returns:<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>net<span class="classifier">torch.nn.Module</span></dt><dd><p>A neural network which has been trained on a simulated dataset</p>
</dd>
</dl>
</section>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">YOLO Main Functions:</a><ul>
<li><a class="reference internal" href="#yolo_help.GroundTruthDataset"><code class="docutils literal notranslate"><span class="pre">GroundTruthDataset</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.Net"><code class="docutils literal notranslate"><span class="pre">Net</span></code></a><ul>
<li><a class="reference internal" href="#yolo_help.Net.forward"><code class="docutils literal notranslate"><span class="pre">Net.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#yolo_help.VariableInputConv2d"><code class="docutils literal notranslate"><span class="pre">VariableInputConv2d</span></code></a><ul>
<li><a class="reference internal" href="#yolo_help.VariableInputConv2d.forward"><code class="docutils literal notranslate"><span class="pre">VariableInputConv2d.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#yolo_help.bbox_to_rectangles"><code class="docutils literal notranslate"><span class="pre">bbox_to_rectangles()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.convert_data"><code class="docutils literal notranslate"><span class="pre">convert_data()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.get_assignment_inds"><code class="docutils literal notranslate"><span class="pre">get_assignment_inds()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.get_best_bounding_box_per_cell"><code class="docutils literal notranslate"><span class="pre">get_best_bounding_box_per_cell()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.get_reg_targets"><code class="docutils literal notranslate"><span class="pre">get_reg_targets()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.imshow"><code class="docutils literal notranslate"><span class="pre">imshow()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.iou"><code class="docutils literal notranslate"><span class="pre">iou()</span></code></a></li>
<li><a class="reference internal" href="#yolo_help.train_yolo_model"><code class="docutils literal notranslate"><span class="pre">train_yolo_model()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">Welcome to the YOLO model documentation!</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="yolo_post_help.html"
                          title="next chapter">YOLO Post-processing Functions:</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/yolo_help.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="yolo_post_help.html" title="YOLO Post-processing Functions:"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to the YOLO model documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">yolo_model  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">YOLO Main Functions:</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Andrew Bennecke, Daniel Tward.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>